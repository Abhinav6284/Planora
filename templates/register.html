<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<<<<<<< HEAD
    <title>Create Your Account - Planora</title>
=======
    <title>Register - Planora</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=SF+Pro+Display:wght@400;500;600;700;800&display=swap" rel="stylesheet">
>>>>>>> 724e44c07083fdf373ac3d299bd9c3b2da4de062
    <link rel="stylesheet" href="{{ url_for('static', filename='css/register.css') }}">
</head>

<body>
    <main class="page-container">
        <section class="image-section">
            <div class="branding-content">
                <header>
                    <h1>Planora</h1>
                    <h2>Begin Your Journey</h2>
                    <p class="subheading">Join thousands of users planning smarter with Planora.</p>
                </header>
                <img src="{{ url_for('static', filename='images/registersection1.png') }}"
                    alt="Students collaborating on a planning project">
            </div>
        </section>

        <section class="right-side">
            <div class="register-container">
                <header class="form-header">
                    <h2>Create Your Account</h2>
                    <p>Get started with your free Planora account</p>
                </header>

                <div id="message-container" class="message-container"></div>

                <form id="registerForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="first_name">First Name</label>
                            <input type="text" id="first_name" name="first_name">
                        </div>
                        <div class="form-group">
                            <label for="last_name">Last Name</label>
                            <input type="text" id="last_name" name="last_name">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="username">Username <span class="required">*</span></label>
                        <input type="text" id="username" name="username" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address <span class="required">*</span></label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="password">Password <span class="required">*</span></label>
                        <input type="password" id="password" name="password" required minlength="6">
                    </div>

                    <div class="form-group">
                        <label for="confirm_password">Confirm Password <span class="required">*</span></label>
                        <input type="password" id="confirm_password" name="confirm_password" required>
                    </div>

<<<<<<< HEAD
                    <button type="submit" class="register-btn" id="submitBtn">Create Account</button>
                </form>

                <div class="divider">
                    <span class="divider-line"></span>
                    <p class="divider-text">Or sign up with</p>
                    <span class="divider-line"></span>
                </div>

                <div class="social-login-section">
                    <div class="social-icons">
                        <a href="#" aria-label="Sign up with Google"><img
                                src="{{ url_for('static', filename='images/google.png') }}" alt="Google icon"></a>
                        <a href="#" aria-label="Sign up with GitHub"><img
                                src="{{ url_for('static', filename='images/github.png') }}" alt="GitHub icon"></a>
                        <a href="#" aria-label="Sign up with LinkedIn"><img
                                src="{{ url_for('static', filename='images/linkedin.png') }}" alt="LinkedIn icon"></a>
                    </div>
                </div>

=======
                    <!-- This input field is hidden by default and appears when "Other" is selected -->
                    <div class="form-group" id="how-heard-other-group">
                        <label for="how-heard-other">Please specify</label>
                        <input type="text" id="how-heard-other" name="how-heard-other">
                    </div>

                    <div class="form-group">
                        <label for="terms" class="checkbox-label">
                            <input type="checkbox" id="terms" name="terms" required>
                            I agree to the <a href="/terms">Terms and Conditions</a>
                        </label>
                    </div>
                    
                    <button type="submit" class="submit-btn">Create Account</button>
                </form>
>>>>>>> 724e44c07083fdf373ac3d299bd9c3b2da4de062
                <footer class="form-footer">
                    <p class="login-prompt">
                        Already have an account? <a href="/login">Sign In</a>
                    </p>
                </footer>
            </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const registerForm = document.getElementById('registerForm');
            const submitBtn = document.getElementById('submitBtn');
            const messageContainer = document.getElementById('message-container');
            const passwordInput = document.getElementById('password');
            const confirmPasswordInput = document.getElementById('confirm_password');

            // Helper function to display messages
            function showMessage(message, isError = true) {
                messageContainer.textContent = message;
                messageContainer.style.color = isError ? '#ff5555' : '#28a745';
                messageContainer.style.display = 'block';
            }

            registerForm.addEventListener('submit', async function (event) {
                // 1. Prevent the default browser form submission
                event.preventDefault();

                // 2. Client-side validation
                if (passwordInput.value !== confirmPasswordInput.value) {
                    showMessage("Passwords do not match.");
                    return;
                }
                if (passwordInput.value.length < 6) {
                    showMessage("Password must be at least 6 characters long.");
                    return;
                }

                // Clear any previous messages and disable the button
                showMessage('', false);
                submitBtn.disabled = true;
                submitBtn.textContent = 'Creating Account...';

                // 3. Create a data object from the form inputs
                const formData = new FormData(registerForm);
                const data = Object.fromEntries(formData.entries());

                try {
                    // 4. Send the form data to your Flask API endpoint
                    const response = await fetch("/api/auth/register", {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    const result = await response.json();

                    // 5. Handle the API's response
                    if (result.success) {
                        // SUCCESS! The API created the user and gave us a token.
                        showMessage('Account created successfully! Redirecting to login...', false);

                        // 6. Redirect to the login page after a short delay
                        setTimeout(() => {
                            window.location.href = "/login";
                        }, 2000);

                    } else {
                        // If the API returns an error (e.g., username taken)
                        throw new Error(result.message || 'Registration failed.');
                    }

                } catch (error) {
                    // This will catch network errors or errors thrown from the API
                    showMessage(error.message);

                    // Re-enable the button so the user can try again
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Create Account';
                }
            });
        });
    </script>
</body>

</html>